-- VHDL Entity ttc.ttc_top.symbol
--
-- Created by Matt Warren 2013
--
-- Generated by Mentor Graphics' HDL Designer(TM) 2012.1 (Build 6)
--

LIBRARY ieee;
USE ieee.std_logic_1164.all;
USE ieee.std_logic_arith.all;

entity ttc_top is
   port( 
      clk            : in     std_logic;
      rst            : in     std_logic;
      strobe40_i     : in     std_logic;
      ttc_controls_i : in     std_logic_vector (15 downto 0);
      ttc_data_i     : in     std_logic_vector (15 downto 0);
      fe_11a_o       : out    std_logic;
      fe_l0a_o       : out    std_logic;
      -- Output
      fe_r3_o        : out    std_logic;
      fe_r3s_o       : out    std_logic
   );

-- Declarations

end ttc_top ;

-- VHDL from Block Diagram 
-- Generated by Mentor Graphics HDL Designer(TM) 2012.1 (Build 6) 
--
-- ttc.ttc_top.struct
--
-- Created by Matt Warren 2013
--

LIBRARY ieee;
USE ieee.std_logic_1164.all;
USE ieee.std_logic_arith.all;


architecture struct of ttc_top is

   -- Architecture declarations

   -- Internal signal declarations
   signal HI               : std_logic;
   signal LO               : std_logic;
   signal r3_l0id          : std_logic_vector(7 downto 0);
   signal r3_map           : std_logic_vector(13 downto 0);
   -- Output
   signal r3_valid         : std_logic;
   signal ram_addr         : std_logic_vector(11 downto 0);
   signal ram_din          : std_logic_vector(15 downto 0);
   signal ttc_l1a          : std_logic;
   signal ttc_l1a_l0id     : std_logic_vector(7 downto 0);
   signal ttc_r3           : std_logic;
   signal ttc_r3_l0id      : std_logic_vector(7 downto 0);
   signal ttc_r3_roi       : std_logic_vector(11 downto 0);
   signal ttc_r3_roi_valid : std_logic;


   -- Component Declarations
   component l1_encoder
   port (
      clk          : in     std_logic ;
      rst          : in     std_logic ;
      strobe40     : in     std_logic ;
      ttc_l1a      : in     std_logic ;
      ttc_l1a_l0id : in     std_logic_vector (7 downto 0);
      fe_11a_o     : out    std_logic 
   );
   end component;
   component r3_encoder
   port (
      -- Input
      r3_map_i   : in     std_logic_vector (13 downto 0);
      r3_valid_i : in     std_logic ;
      r3_l0id_i  : in     std_logic_vector (7 downto 0);
      -- Output
      fe_r3_o    : out    std_logic ;
      fe_r3s_o   : out    std_logic ;
      -- Infrastructure
      strobe40_i : in     std_logic ;
      clk        : in     std_logic ;
      rst        : in     std_logic 
   );
   end component;
   component r3_patmat
   port (
      -- Input
      ttc_r3_i           : in     std_logic ;
      ttc_r3_l0id_i      : in     std_logic_vector (7 downto 0);
      ttc_r3_roi_i       : in     std_logic_vector (11 downto 0);
      ttc_r3_roi_valid_i : in     std_logic ;
      -- Output
      r3_valid_o         : out    std_logic ;
      r3_l0id_o          : out    std_logic_vector (7 downto 0);
      r3_map_o           : out    std_logic_vector (13 downto 0);
      -- Ext RAM interface
      ram_rdy_o          : out    std_logic ;
      ram_we_i           : in     std_logic ;
      ram_addr_i         : in     std_logic_vector (11 downto 0);
      ram_din_i          : in     std_logic_vector (15 downto 0);
      ram_dout_o         : out    std_logic_vector (15 downto 0);
      -- Infrastructure
      strobe40_i         : in     std_logic ;
      clk                : in     std_logic ;
      rst                : in     std_logic 
   );
   end component;
   component ttc_decode
   port (
      sim_mode_i         : in     std_logic ;
      -- TTC Inputs
      ttc_controls_i     : in     std_logic_vector (15 downto 0);
      ttc_data_i         : in     std_logic_vector (15 downto 0);
      -- TTC Outputs
      ttc_l0a_o          : out    std_logic ;
      ttc_l1a_o          : out    std_logic ;
      ttc_l1a_l0id_o     : out    std_logic_vector (7 downto 0);
      ttc_r3_o           : out    std_logic ;
      ttc_r3_l0id_o      : out    std_logic_vector (7 downto 0);
      ttc_r3_roi_o       : out    std_logic_vector (11 downto 0);
      ttc_r3_roi_valid_o : out    std_logic ;
      -- Infrastructure
      strobe40_i         : in     std_logic ;
      clk                : in     std_logic ;
      rst                : in     std_logic 
   );
   end component;


begin
   -- Architecture concurrent statements
   -- HDL Embedded Text Block 1 eb1
   LO <= '0';
   HI <= '1';


   -- ModuleWare code(v1.9) for instance 'U_0' of 'constval'
   ram_din <= "0000000000000000";

   -- ModuleWare code(v1.9) for instance 'U_1' of 'constval'
   ram_addr <= "000000000000";

   -- Instance port mappings.
   Ul1e : l1_encoder
      port map (
         clk          => clk,
         rst          => rst,
         strobe40     => strobe40_i,
         ttc_l1a      => ttc_l1a,
         ttc_l1a_l0id => ttc_l1a_l0id,
         fe_11a_o     => fe_11a_o
      );
   Ur3e : r3_encoder
      port map (
         r3_map_i   => r3_map,
         r3_valid_i => r3_valid,
         r3_l0id_i  => r3_l0id,
         fe_r3_o    => fe_r3_o,
         fe_r3s_o   => fe_r3s_o,
         strobe40_i => strobe40_i,
         clk        => clk,
         rst        => rst
      );
   Upatmat : r3_patmat
      port map (
         ttc_r3_i           => ttc_r3,
         ttc_r3_l0id_i      => ttc_r3_l0id,
         ttc_r3_roi_i       => ttc_r3_roi,
         ttc_r3_roi_valid_i => ttc_r3_roi_valid,
         r3_valid_o         => r3_valid,
         r3_l0id_o          => r3_l0id,
         r3_map_o           => r3_map,
         ram_rdy_o          => open,
         ram_we_i           => LO,
         ram_addr_i         => ram_addr,
         ram_din_i          => ram_din,
         ram_dout_o         => open,
         strobe40_i         => strobe40_i,
         clk                => clk,
         rst                => rst
      );
   Utd : ttc_decode
      port map (
         sim_mode_i         => HI,
         ttc_controls_i     => ttc_controls_i,
         ttc_data_i         => ttc_data_i,
         ttc_l0a_o          => fe_l0a_o,
         ttc_l1a_o          => ttc_l1a,
         ttc_l1a_l0id_o     => ttc_l1a_l0id,
         ttc_r3_o           => ttc_r3,
         ttc_r3_l0id_o      => ttc_r3_l0id,
         ttc_r3_roi_o       => ttc_r3_roi,
         ttc_r3_roi_valid_o => ttc_r3_roi_valid,
         strobe40_i         => strobe40_i,
         clk                => clk,
         rst                => rst
      );

end struct;
